{% extends "market/base.html" %}
{% load static %}

{% block title %}Каталог моделей — CameraPriceMonitor{% endblock %}

{% block content %}
  <!-- Hero Section with Camera Image -->
  <div class="catalog-hero-section mb-5">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6 text-center text-lg-start mb-4 mb-lg-0">
          <div class="camera-image-wrapper mb-4">
            <img src="{% static 'images/camera.png' %}" alt="Фотоаппарат" class="camera-image">
          </div>
        </div>
        <div class="col-lg-6">
          <h1 class="catalog-hero-title mb-4">Определяй реальную стоимость фотоаппаратов</h1>
          <button class="btn btn-primary btn-lg scroll-to-catalog" onclick="document.getElementById('catalog-section').scrollIntoView({behavior: 'smooth', block: 'start'})">
            Выбрать модель
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" style="margin-left: 0.5rem; vertical-align: middle;">
              <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Catalog Section -->
  <div id="catalog-section">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="mb-0">Каталог моделей</h2>
      <div class="text-muted small">
        Всего моделей: <strong>{{ models.count }}</strong>
      </div>
    </div>

    {% if models %}
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-4">
      {% for model in models %}
        <div class="col">
          <div class="camera-card">
            <div class="camera-card-header">
              <div class="camera-brand">{{ model.brand.name }}</div>
              <h3 class="camera-name">{{ model.name }}</h3>
            </div>

            <div class="camera-card-body">
              <div class="camera-specs">
                {% if model.release_year %}
                  <div class="spec-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="spec-icon">
                      <path d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z"/>
                      <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                      <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                    </svg>
                    <span>{{ model.release_year }} г.</span>
                  </div>
                {% endif %}
                {% if model.mount %}
                  <div class="spec-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="spec-icon">
                      <path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z"/>
                    </svg>
                    <span>{{ model.mount }}</span>
                  </div>
                {% endif %}
                {% if model.sensor_type %}
                  <div class="spec-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="spec-icon">
                      <path d="M6 3a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM1 3a2 2 0 1 0 4 0 2 2 0 0 0-4 0z"/>
                      <path d="M9 6a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
                      <path d="M6 7a4 4 0 0 1 4 4v4a4 4 0 0 1-4 4H2a4 4 0 0 1-4-4v-4a4 4 0 0 1 4-4h4zM2 8a3 3 0 0 0-3 3v4a3 3 0 0 0 3 3h4a3 3 0 0 0 3-3v-4a3 3 0 0 0-3-3H2zm11 2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm-1 0a2 2 0 1 0-4 0 2 2 0 0 0 4 0z"/>
                    </svg>
                    <span>{{ model.sensor_type }}</span>
                  </div>
                {% endif %}
              </div>

              {% if model.listings_count > 0 %}
                <div class="camera-stats">
                  <div class="stat-badge">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M0 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2zm12 2H5a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1z"/>
                    </svg>
                    {{ model.listings_count }} объявл.
                  </div>
                  {% if model.min_price %}
                    <div class="stat-price">
                      {% if model.min_price == model.max_price %}
                        {{ model.min_price|floatformat:0 }} ₽
                      {% else %}
                        от {{ model.min_price|floatformat:0 }} ₽
                        {% if model.max_price %}
                          до {{ model.max_price|floatformat:0 }} ₽
                        {% endif %}
                      {% endif %}
                    </div>
                    {% if model.avg_price %}
                      <div class="stat-avg">
                        Средняя: <strong>{{ model.avg_price|floatformat:0 }} ₽</strong>
                      </div>
                    {% endif %}
                  {% endif %}
                </div>
              {% else %}
                <div class="camera-stats">
                  <div class="stat-empty">Нет объявлений</div>
                </div>
              {% endif %}
            </div>

            <div class="camera-card-footer">
              <a href="{% url 'camera_detail' model.id %}" class="btn btn-primary w-100">
                Подробнее
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="margin-left: 0.5rem;">
                  <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" viewBox="0 0 16 16" class="empty-icon">
        <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
        <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v8.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
      </svg>
      <h3>Пока нет моделей</h3>
      <p class="text-muted">Добавьте модели камер в каталог через админ-панель</p>
    </div>
  {% endif %}
  </div>
{% endblock %}



